// Request Forwarding Configuration models

model RequestForwardingConfiguration {
  id            String   @id @default(uuid())
  requestType   String   // "exemption" | "attendance"
  approvalFlow  String   // "auto-approved" | "multi-level"
  status        String   @default("active") // active, inactive
  createdById   String?
  createdBy     User?    @relation("RequestForwardingConfigCreatedBy", fields: [createdById], references: [id])
  updatedById   String?
  updatedBy     User?    @relation("RequestForwardingConfigUpdatedBy", fields: [updatedById], references: [id])
  createdAt     DateTime @default(now())
  updatedAt     DateTime @updatedAt

  // Relations
  approvalLevels RequestForwardingApprovalLevel[]

  @@unique([requestType])
  @@index([requestType])
  @@index([status])
}

model RequestForwardingApprovalLevel {
  id                    String   @id @default(uuid())
  configurationId       String
  configuration         RequestForwardingConfiguration @relation(fields: [configurationId], references: [id], onDelete: Cascade)
  level                 Int      // Sequential level number (1, 2, 3, ...)
  approverType          String   // "specific-employee" | "department-head" | "sub-department-head" | "reporting-manager"
  departmentHeadMode    String?  // "auto" | "specific" (only for department-head and sub-department-head)
  
  // Optional approver references
  specificEmployeeId    String?  // For "specific-employee" approver type
  specificEmployee      Employee? @relation("RequestForwardingSpecificEmployee", fields: [specificEmployeeId], references: [id], onDelete: SetNull)
  
  departmentId          String?   // For "department-head" or "sub-department-head" when mode is "specific"
  department            Department? @relation("RequestForwardingDepartment", fields: [departmentId], references: [id], onDelete: SetNull)
  
  subDepartmentId       String?   // For "sub-department-head" when mode is "specific"
  subDepartment         SubDepartment? @relation("RequestForwardingSubDepartment", fields: [subDepartmentId], references: [id], onDelete: SetNull)
  
  createdAt             DateTime  @default(now())
  updatedAt             DateTime  @updatedAt

  @@index([configurationId])
  @@index([level])
  @@index([approverType])
}
